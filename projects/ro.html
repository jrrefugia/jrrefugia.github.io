<!doctype html><html><head><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script>var maps={a: [{x: 2, y: 3},{x: 3, y: 0},{x: 3, y: 8},{x: 4, y: 5},{x: 6, y: 6},{x: 7, y: 1},{x: 7, y: 3},{x: 7, y: 8}], b: [{x: 2, y: 3},{x: 3, y: 0},{x: 3, y: 8},{x: 6, y: 6},{x: 7, y: 1},{x: 7, y: 3}], c: [{x: 2, y: 3},{x: 3, y: 3},{x: 4, y: 3},{x: 6, y: 5},{x: 6, y: 6},{x: 7, y: 6}], d: [{x: 1, y: 6},{x: 1, y: 7},{x: 2, y: 1},{x: 2, y: 2},{x: 3, y: 8},{x: 6, y: 1},{x: 6, y: 6},{x: 7, y: 8},{x: 8, y: 3},{x: 8, y: 6}], e: [{x: 1, y: 1},{x: 1, y: 8},{x: 4, y: 4},{x: 6, y: 2},{x: 6, y: 8},{x: 7, y: 6},{x: 9, y: 4}]};var arrayMap=[];var dim=10;var path=[];var silences=[];var validStart=[];var validEnd=[];var silentEnds=[];var map="a";if (typeof getUrlVars()["map"]=="string"){map=getUrlVars()["map"];}$(document).ready(function(){for (i=0; i < dim; i++){arrayMap.push([]); validStart.push([]); validEnd.push([]); for (j=0; j < dim; j++){temp=true; for (c in maps[map]){ctx=maps[map][c]; if (ctx.x==j && ctx.y==i){temp=false;}}arrayMap[i].push(temp); validStart[i].push(temp); validEnd[i].push(false);}}var abc=["a","b","c","d","e","f","g","h","i","j"]; for (i in arrayMap){$("#map").append('<div></div>'); for (j in arrayMap[i]){$("#map > div").eq(i).append('<div data-coords="'+ (Number(i)+1) + "" + abc[j].toUpperCase() +'" class="' + ((arrayMap[i][j])==true ? 'valid' : 'invalid') + '"></div>');}}document.onkeydown=checkKey; function checkKey(e){e=e || window.event; if (e.keyCode=='38' || e.keyCode=='87'){$("#n").click();}else if (e.keyCode=='40' || e.keyCode=='83'){$("#s").click();}else if (e.keyCode=='37' || e.keyCode=='65'){$("#w").click();}else if (e.keyCode=='39' || e.keyCode=='68'){$("#e").click();}else if (e.keyCode==69){$("#silence").click();}else if (e.keyCode==81){$("#undo").click();}else if (e.keyCode==0 || e.keyCode==32){location.href=window.location.pathname;}}function redrawMap(){$("#map .last").removeClass("last"); for (i in validStart){for (j in validStart[i]){if (validStart[i][j]){var validPath; var temp=null; for (k in path){if (temp==null){temp={x: j, y: i}}validPath=pathPossible(path[k], temp); if (validPath !=false){temp=validPath;}if (validPath==false){validStart[i][j]=false; validEnd[i][j]=false;}}}else{validStart[i][j]=false; validEnd[i][j]=false;}}}var validStartCount=0; var finalValidStart={}; $(".path").removeClass("path").html(""); for (i in validStart){for (j in validStart[i]){validEnd[i][j]=false;}}for (i in validStart){for (j in validStart[i]){var ctx=$("#map > div").eq(i).find("div").eq(j); if (validStart[i][j]){validStartCount++; finalValidStart.x=j; finalValidStart.y=i; ctx.addClass("path"); var validPath; var temp=null; for (k in path){if (temp==null){temp=temp={x: j, y: i}}validPath=pathPossible(path[k], temp); temp=validPath; if (String(path.length - 1)==k){$("#map > div").eq(validPath.y).find("div").eq(validPath.x).addClass("last"); validEnd[validPath.y][validPath.x]=true;}}}}}$("#map > div .silence").removeClass("silence").html(""); if (validStartCount==1){var temp=null; for (k in path){if (temp==null){temp=finalValidStart}validPath=pathPossible(path[k], temp); temp=validPath; $("#map > div").eq(validPath.y).find("div").eq(validPath.x).addClass("path");}}for (i in silentEnds){$("#map > div").eq(silentEnds[i].y).find("div").eq(silentEnds[i].x).addClass("silence").html("?");}}$(".db").click(function(){var dir=$(this).html().substr(0, 1).toLowerCase(); if (oppositeDir(path[path.length - 1])==dir){return false;}$("#coordlist option:selected").removeAttr("selected"); $("#coordlist").append('<option selected="selected">' + $(this).html() + '</option>'); path.push(dir); silences.push(0); var tempSilentEnds=[]; for (i in silentEnds){ctx=pathPossible(dir, silentEnds[i]); if (ctx){matchFound=false; for (c in tempSilentEnds){if (tempSilentEnds[c].x==ctx.x && ctx.y==tempSilentEnds[c].y){matchFound=true; break;}}if (!matchFound){tempSilentEnds.push(ctx);}$("#map > div").eq(ctx.y).find("div").eq(ctx.x).addClass("silence").html("?");}}if (tempSilentEnds.length){silentEnds=tempSilentEnds;}redrawMap();}); $("#silence").click(function(){var validEnds=[]; silences.splice((silences.length - 1), 1); silences.push(1); for (i in validEnd){for (j in validEnd[i]){if (validEnd[i][j]){validEnds.push({x: j, y: i});}}}var silMoves=[1, 2, 3, 4]; var dirs=["n", "s", "e", "w"]; if (silentEnds.length){for (c in silentEnds){for (i in dirs){var validPath; var temp={x: silentEnds[c].x, y: silentEnds[c].y}; if (i==0){silentEnds.push(temp);}if (dirs[i] !=oppositeDir(path[path.length - 1])){for (j in silMoves){validPath=pathPossible(dirs[i], temp); if (validPath !=false){temp=validPath; match=false; for (s in silentEnds){if (silentEnds[s].x==temp.x && silentEnds[s].y==temp.y){match=true; break;}}if (!match){silentEnds.push(temp);}}}}}}}for (c in validEnds){for (i in dirs){var validPath; var temp={x: validEnds[c].x, y: validEnds[c].y}; if (i==0){silentEnds.push(temp);}if (dirs[i] !=oppositeDir(path[path.length - 1])){for (j in silMoves){validPath=pathPossible(dirs[i], temp); if (validPath !=false){temp=validPath; match=false; for (s in silentEnds){if (silentEnds[s].x==temp.x && silentEnds[s].y==temp.y){match=true; break;}}if (!match){silentEnds.push(temp);}}}}}}redrawMap();}); var oldPath=[]; var oldsilences=[]; if (getUrlVars()["path"]){oldPath=getUrlVars()["path"].split(",");}if (getUrlVars()["silences"]){oldsilences=getUrlVars()["silences"].split(",");}if (typeof getUrlVars()["map"]=="string"){$('#mapselect option[value="' + getUrlVars()["map"] + '"]').prop("selected", true);}if (oldPath.length){if (oldPath[0] !=""){for (i in oldPath){silenceFound=false; if (oldsilences[i]=="1"){silenceFound=true;}$("#" + oldPath[i]).click(); if (silenceFound){$("#silence").click();}}}}$("#undo").click(function(){path.splice((path.length - 1), 1); silences.splice((silences.length - 1), 1); location.href=window.location.pathname + "?map=" + map + "&path=" + path + "&silences=" + silences;}); $("#mapselect").change(function(){if($(this).val() !=""){map=$(this).val();}location.href=window.location.pathname + "?map=" + map;}); $("#map > div > div").click(function(){if ($(this).hasClass("last")){validPath=true; temp={x: ($(this).index()), y: ($(this).parent().index())}; for (k=(path.length - 1); k >=0; k--){temp=pathPossible(oppositeDir(path[k]), temp); if (temp==false){validPath=false; break;}}if (validPath){validStart[temp.y][temp.x]=false; redrawMap();}}if ($(this).hasClass("silence")){for(key in silentEnds){ctx=silentEnds[key];if(ctx.x==$(this).index() && ctx.y==$(this).parent().index()){silentEnds.splice(key, 1);redrawMap();break;}}}});});function getUrlVars(){var vars=[], hash; var hashes=window.location.href.slice(window.location.href.indexOf('?') + 1).split('&'); for (var i=0; i < hashes.length; i++){hash=hashes[i].split('='); vars.push(hash[0]); vars[hash[0]]=hash[1];}return vars;}function oppositeDir(dir){switch (dir){case 'n': dir='s'; break; case 's': dir='n'; break; case 'e': dir='w'; break; case 'w': dir='e'; break;}return dir;}function getOffset(dir){switch (dir){case 'n': offset={x: 0, y: -1}; break; case 's': offset={x: 0, y: 1}; break; case 'e': offset={x: 1, y: 0}; break; case 'w': offset={x: -1, y: 0}; break;}return offset;}function pathPossible(dir, arrayCoord){var ctx=addCoObj(arrayCoord, getOffset(dir)); try{if (arrayMap[ctx.y][ctx.x]){return ctx;}else{return false;}}catch (e){return false;}}function addCoObj(obj1, obj2){returnObj={}; for (key in obj1){returnObj[key]=String(Number(obj1[key]) + Number(obj2[key]));}return returnObj;}</script><style>*{box-sizing: border-box;}#map{float:left;width:60%;}#map div::before{content:attr(data-coords);color:white;float:right;bottom:-17px;right:17px;position:relative;}#map div{height:53px;width:53px;display:inline-block;padding:0;margin:1px;border-collapse:collapse; color: white; vertical-align: top;}#map > div{display:block;width:560px;}#map .valid{background-color:blue;}#map .valid.path{background-color:DarkCyan ;}#map .valid.last{background-color:maroon;}#map .valid.last.path{background-color:red;}#map .valid.silence{opacity:.60;}#map .invalid{background-color:black;}.but{height:100px;width:100px;border: 1px solid #ccc;padding:10px;}.db{position:relative;}#n{margin:0 auto;}#e{float:right;}#s{margin:0 auto;}#silence{float:left;}#undo{float:right;}#mapselect,#coordlist{margin-left:15%;}</style></head><body><div id="map"></div><div style="width:40%; float:left;"><div class="db but" id="n">north</div><br><br><div class="db but" id="e">east</div><div class="db but" id="w">west</div><br><br><div class="db but" id="s">south</div><br><br><br><div class="but" id="silence">silence</div><div class="but" id="undo">undo</div><select id="coordlist"></select><br><br><br><select id="mapselect"><option value="">reset</option><option value="a">alpha</option><option value="b">bravo</option><option value="c">charlie</option><option value="d">delta</option><option value="e">echo</option></select></div></body></html>
